<div id="matrix-modal" class="modal fade">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">LOCK/UNLOCK MATRIX CARD</h4>
      </div>

      <div class="modal-body">

        <form class="form">
          <!-- ROW 1: NODE, SHELF, SLOT, TYPE -->
          <div class="row">
            <div class="col-md-2">
              <div class="form-group">
                <label>NODE</label>
                <input type="number" class="form-control matrix-modal-input" id="matrix-modal-node" target="node" disabled>
              </div>
            </div>
            <div class="col-md-2">
              <div class="form-group">
                <label>SHELF</label>
                <input type="number" class="form-control matrix-modal-input" id="matrix-modal-shelf" target="shelf" disabled>
              </div>
            </div>
            <div class="col-md-2">
              <div class="form-group">
                <label>SLOT</label>
                <input type="number" class="form-control matrix-modal-input" id="matrix-modal-slot" target="slot" disabled>
              </div>
            </div>
            <div class="col-md-2">
              <div class="form-group">
                <label>TYPE</label>
                <input type="text" class="form-control matrix-modal-input" id="matrix-modal-type" target="type" disabled>
              </div>
            </div>
          </div>
          <!-- END ROW 1 -->
        </form>

        <!-- Action Field -->
        <div class="row">
          <div class="col-md-3">
            <div class="form-group">
              <label>ACTION</label>
              <input type="text" class="form-control matrix-modal-input" id="matrix-modal-action" action="" readonly>
            </div>
            <div class="form-group">
              <label id="matrix-modal-result"></label>
            </div>
          </div>
        </div>

      </div>

      <div class="modal-footer">
        <form class="form">
          <div class="form-group">
            <button id="matrix-modal-submit" type="button" class="btn btn-primary pull-left">Submit</button>
          </div>
          <div class="form-group">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">

  $(document).ready(function() {
    // WHEN MODAL IS HIDDEN
    $("#matrix-modal").on('hidden.bs.modal', function() {
      $("#matrix-form-action").val("");
      queryMatrixPorts();
      $("#matrix-modal-result").text("");
    });

    // SUBMIT BUTTON
    $("#matrix-modal-submit").click(function() {
      clearErrors();
      $("#matrix-modal-result").text("");

      let action = $("#matrix-modal-action").attr('action');
      $.ajax({
        type: "POST",
        url: ipcDispatch,
        data: {
          api:    "ipcMxc",
          act:    action,
          user:   user.uname,
          id:     $("#matrix-modal-id").val(),
          node:   $("#matrix-modal-node").val(),
          shelf:  $("#matrix-modal-shelf").val(),
          slot:   $("#matrix-modal-slot").val(),
          type:   $("#matrix-modal-type").val(),
        },
        dataType: 'json'
      }).done(function(data) {
        let res = data.rows;
        let modal = {
          title: data.rslt,
          body: data.reason,
        }
        if (data.rslt === 'fail') {
          $("#matrix-modal-result").text(data.rslt + ": " + data.reason).css('color', 'red');
        } else {
          if (action == "VIEW_PORT_STATUS") {
            if (res.length === 0) {
              $("#matrix-modal-result").text(data.rslt + ": " + data.reason).css('color', 'red');
            } else {
              $("#matrix-modal-result").text(data.rslt + ": " + data.reason).css('color', 'green');
            }
            $("#matrix-form-action").val("");
            return;
          }
          $("#matrix-modal-result").text(data.rslt + ": " + data.reason).css('color', 'green');
          queryMatrixCards();
        }
      });
    });
  });
</script>